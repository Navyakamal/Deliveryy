(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[91892,62973,85040,55530],{80170:(e,t,n)=>{var r="__lodash_hash_undefined__",s="[object Function]",i="[object GeneratorFunction]",o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/,c=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l=/\\(\\)?/g,d=/^\[object .+?Constructor\]$/,h="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,p="object"==typeof self&&self&&self.Object===Object&&self,f=h||p||Function("return this")();var m=Array.prototype,g=Function.prototype,v=Object.prototype,b=f["__core-js_shared__"],_=function(){var e=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),y=g.toString,x=v.hasOwnProperty,C=v.toString,k=RegExp("^"+y.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),w=f.Symbol,O=m.splice,S=A(f,"Map"),E=A(Object,"create"),Z=w?w.prototype:void 0,T=Z?Z.toString:void 0;function M(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function D(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function R(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function H(e,t){for(var n=e.length;n--;)if(N(e[n][0],t))return n;return-1}function P(e,t){for(var n=0,r=(t=function(e,t){if(j(e))return!1;var n=typeof e;if("number"==n||"symbol"==n||"boolean"==n||null==e||z(e))return!0;return a.test(e)||!o.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function(e){return j(e)?e:L(e)}(t)).length;null!=e&&n<r;)e=e[$(t[n++])];return n&&n==r?e:void 0}function I(e){return!(!q(e)||function(e){return!!_&&_ in e}(e))&&(function(e){var t=q(e)?C.call(e):"";return t==s||t==i}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?k:d).test(function(e){if(null!=e){try{return y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function B(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function A(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return I(n)?n:void 0}M.prototype.clear=function(){this.__data__=E?E(null):{}},M.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},M.prototype.get=function(e){var t=this.__data__;if(E){var n=t[e];return n===r?void 0:n}return x.call(t,e)?t[e]:void 0},M.prototype.has=function(e){var t=this.__data__;return E?void 0!==t[e]:x.call(t,e)},M.prototype.set=function(e,t){return this.__data__[e]=E&&void 0===t?r:t,this},D.prototype.clear=function(){this.__data__=[]},D.prototype.delete=function(e){var t=this.__data__,n=H(t,e);return!(n<0)&&(n==t.length-1?t.pop():O.call(t,n,1),!0)},D.prototype.get=function(e){var t=this.__data__,n=H(t,e);return n<0?void 0:t[n][1]},D.prototype.has=function(e){return H(this.__data__,e)>-1},D.prototype.set=function(e,t){var n=this.__data__,r=H(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},R.prototype.clear=function(){this.__data__={hash:new M,map:new(S||D),string:new M}},R.prototype.delete=function(e){return B(this,e).delete(e)},R.prototype.get=function(e){return B(this,e).get(e)},R.prototype.has=function(e){return B(this,e).has(e)},R.prototype.set=function(e,t){return B(this,e).set(e,t),this};var L=F((function(e){e=function(e){return null==e?"":function(e){if("string"==typeof e)return e;if(z(e))return T?T.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(e);var t=[];return c.test(e)&&t.push(""),e.replace(u,(function(e,n,r,s){t.push(r?s.replace(l,"$1"):n||e)})),t}));function $(e){if("string"==typeof e||z(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function F(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var o=e.apply(this,r);return n.cache=i.set(s,o),o};return n.cache=new(F.Cache||R),n}function N(e,t){return e===t||e!=e&&t!=t}F.Cache=R;var j=Array.isArray;function q(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function z(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==C.call(e)}e.exports=function(e,t,n){var r=null==e?void 0:P(e,t);return void 0===r?n:r}},40810:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(25565),s=n(99849);const i=(0,r.zo)("button",(e=>{let{$theme:t,radius:n}=e;return{...(0,s.Z)({$theme:t,radius:n}),textDecoration:"none",":active":{background:t.colors.backgroundSecondary}}}))},79474:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(20927),s=n(85958),i=n(61072),o=n(76490),a=n(33990);const c=()=>{const e=(0,r.TH)();return(0,a.tZ)(s.ZP,{backLocation:(0,i.N0q)(e),children:(0,a.tZ)(o.Z,{})})}},85958:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>C,a7:()=>y,cN:()=>x});var r=n(36151),s=n(25565),i=n(84791),o=n(43853),a=n(26518),c=n(20927),u=n(97654),l=n(61072),d=n(45896),h=n(99456),p=n(95218),f=n(73591),m=n(44713),g=n(33990);const v=(0,s.zo)("div",(e=>{let{$theme:t,$overlay:n,$takeOverModal:r}=e;return{display:"flex",flexDirection:"column",flex:1,background:t.colors.backgroundPrimary,maxWidth:"100%",height:"100%",position:"relative",zIndex:r?a.I_.base:a.I_.modal,...n?{position:"absolute",top:0,width:"100%"}:{}}})),b=(0,s.zo)("div",(e=>({position:e.$isStuck?"sticky":"relative",zIndex:a.I_.modal,top:0}))),_=(0,s.zo)("div",(e=>({padding:e.$removeTopPadding?"12px 16px 0 16px":"64px 16px 0 16px",height:"100%",boxSizing:"border-box"}))),y=(0,s.Le)(_,(e=>function(t){const{embeddedFeatures:n}=(0,h.v)((e=>{let{embeddedFeatures:t}=e;return{embeddedFeatures:t}})),r=n.xlbHeaderBridge,{children:s,...i}=t;return(0,g.tZ)(e,{$removeTopPadding:r,...i,children:s})})),x=i.Z,C=e=>{var t;const n=(0,c.TH)(),s=(0,u.Z)(),i=r.useContext(m.w),{backLocation:a=(0,l.W57)(n),hasBackButton:_,hasCloseButton:y=!0,inverseColor:x=!1,isHeaderStatic:C,stickyBanner:k,onClose:w=(()=>s(a)),isTakeOverModal:O,isSecondaryCloseButton:S=!1}=e,{elementRef:E,isStuck:Z}=(0,d.Z)(),{embeddedFeatures:T}=(0,h.v)((e=>{let{embeddedFeatures:t}=e;return{embeddedFeatures:t}})),M=T.xlbHeaderBridge;return(0,g.BX)(v,{$overlay:e.overlay,$takeOverModal:null!==(t=null==i?void 0:i.isTakeOverModal)&&void 0!==t?t:O,"data-test":"mobile-dialog",children:[k?(0,g.tZ)(b,{$isStuck:Z,children:(0,g.tZ)(k,{})}):null,(0,g.tZ)(f.Z,{children:(0,g.tZ)(p.Z,{})}),(0,g.tZ)(o.Z,{headerRef:E,hasBackButton:_,hasCloseButton:y,onClose:w,isSecondaryCloseButton:S,hideHeader:!0,inverseColor:x,isStuck:!M&&Z,title:e.title,topRightIconButton:e.topRightIconButton,isHeaderStatic:C}),e.children]})}},48235:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(70081),s=n(36151),i=n(22945),o=n(46643),a=n(78873);const c=e=>{const t=(0,a.Z)(),n=(0,s.useCallback)((t=>{const n=function(e){if(e&&"object"==typeof e&&"string"==typeof e.type){const t=e.payload;return{type:e.type,payload:t&&"object"==typeof t?Object.keys(t).reduce(((e,n)=>(e[n]=t[n],e)),{}):null}}return null}(null==t?void 0:t.data),r=null==t?void 0:t.origin;return!!n&&e(n,r)}),[e]);(0,s.useEffect)((()=>{if(t&&r.Z)return r.Z.addEventListener("message",n),()=>{r.Z&&r.Z.removeEventListener("message",n)}}),[t,n])};var u=n(69429),l=n(19071),d=n(72193),h=n(20977),p=n(61072),f=n(73538),m=n(89509),g=n(20927),v=n(46545),b=n(96322);const _="BACK_TO_FEED",y="HELP",x="ACCOUNT",C="SHOPPING_CART",k="STORE_OVERFLOW",w=()=>{const e=(0,o.k6)(),t=(0,u.Z)(),n=(0,g.TH)(),a=(0,l.Z)(),{totalOrders:w}=(0,f.Z)(),{hydrateDelegatedBooking:O,isDelegatedBooking:S}=(0,v.W)(),E=(0,i.Z)({page:"order"}),Z=(0,p.vN_)(n,"storeOverflowActions"),{toggleIsOpen:T}=(0,h.qi)();return c((0,s.useCallback)(((n,s)=>{if(!S||b.fW.find((e=>e.test(s)))){if("CUSTOM_HEADER_ACTION"===n.type){const s=n.payload;if((null==s?void 0:s.action)===_)e.push(t);else if((null==s?void 0:s.action)===y)(0,m.Z)(E);else if((null==s?void 0:s.action)===x)T();else if((null==s?void 0:s.action)===C){if(!r.Z)return;w<=1?e.push((0,p.nQQ)(r.Z.location)):(0,p.zrB)(r.Z.location,"multicartMobileSwitcher")?e.replace((0,p.C45)(r.Z.location)):e.push((0,p.vN_)(r.Z.location,"multicartMobileSwitcher"))}else(null==s?void 0:s.action)===k&&e.push(Z)}else b.qn.includes(n.type)&&O(n.payload,s);"USER_TRIGGERED_IMPRESSION"===n.type&&((0,d.be)(),a({source:"user_triggered"}))}}),[e,t,E,T,w,Z,a,S,O])),null}},84791:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(25565),s=n(26518),i=n(33990);const o=(0,r.zo)("div",{height:"112px"}),a=(0,r.zo)("div",(e=>{let{$theme:t}=e;return{padding:s.a9,position:"fixed",bottom:0,left:0,right:0,zIndex:s.I_.cover,...t.overlays.floatingButtonGradient}}));function c(e){return(0,i.BX)("div",{children:[(0,i.tZ)(o,{}),(0,i.tZ)(a,{children:e.children})]})}},72598:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(25565),s=n(66351),i=n(26518),o=n(33990);const a=(0,r.zo)("div",(e=>{let{$reverse:t}=e;return{display:"flex",position:"relative",flexDirection:t?"row-reverse":"row"}})),c=(0,r.zo)("input",(e=>{let{$theme:t,checked:n}=e;return{position:"absolute",opacity:0,pointerEvents:"none",outline:"none",":focus[data-focus-visible-added]+label:before":{...n?{boxShadow:"0 0 0 2px ".concat(t.colors.focus)}:{border:"solid 3px ".concat(t.colors.borderSelected)}}}})),u=e=>encodeURIComponent('\n  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0V20H20V0H0ZM8.5 15.1L2.90002 9.5L5 7.39999L8.40002 10.8L14.8 4.39999L16.9 6.5L8.5 15.1Z" fill="'.concat(e,'" />\n  </svg>\n  ')),l=(0,r.zo)("label",(e=>{let{$checked:t,$disabled:n,$reverse:r,$theme:s}=e;return{...s.typography.LabelMedium,width:"100%",display:"flex",boxSizing:"border-box",alignItems:"center",flexDirection:r?"row-reverse":"row",justifyContent:"space-between",cursor:"pointer",fontSize:"16px",lineHeight:"20px",transition:"background-color 100ms ease 0s",":before":{flex:"none",display:"flex",boxSizing:"border-box",border:"solid 3px ".concat(n?s.colors.disabled:s.colors.tickBorder),...t?{border:"0",backgroundColor:s.colors.tickMarkFill,backgroundImage:"url('data:image/svg+xml,".concat(u(s.colors.tickFillSelected),"');"),backgroundPosition:"center center",backgroundSize:"cover"}:{},content:"''",cursor:"pointer",height:i.sh,width:i.sh,verticalAlign:"middle"}}})),d=e=>(0,o.BX)(a,{$reverse:Boolean(e.reverse),children:[e.startElement,(0,o.tZ)(c,{type:"checkbox",id:e.id,name:e.name,value:e.value,checked:e.isChecked,disabled:Boolean(e.isDisabled),onChange:e.onChange}),(0,o.BX)(l,{htmlFor:e.id,$disabled:Boolean(e.isDisabled),$reverse:e.reverse,$checked:e.isChecked,children:[(0,o.tZ)(s.ZP,{$width:"16px"}),e.children]})]})},31287:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(36151),s=n(20927),i=n(84151),o=n(61072),a=n(33990);const c=e=>{var t;const n=(0,s.TH)(),c=i.parse(n.search),u=null!==(t=c[o.FSm.modalContext])&&void 0!==t?t:"";if(c[o.FSm.modalName]===e.modalName||c[o.FSm.popoverName]===e.modalName){if(e.children)return r.Children.map(e.children,(e=>r.cloneElement(e,{modalContext:u})));const t=e.component;if(t)return(0,a.tZ)(t,{modalContext:u})}return null}},70206:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ne});var r=n(36151);const s=()=>{},i=e=>!(!e||"object"!=typeof e)&&("function"==typeof e.timing&&"function"==typeof e.increment),o=()=>({increment:s,timing:s}),a=e=>{try{const t=JSON.parse(e);return"object"==typeof t?t:{}}catch(e){return{}}},c=e=>{let t=!1;return(n,r)=>{t||(t=!0,e(n,r))}},u=(e,t)=>{if(e.xhr.readyState===e.xhr.UNSENT||e.xhr.readyState===e.xhr.DONE)return;Date.now()-e.lastResponse>t&&e.xhr.abort(),setTimeout(u,t,e,t)};function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce(((e,t)=>function(){return e(t(...arguments))}))}const d={ACK:"/events/ack",RECV:"/events/recv"},h={dca1:"dca",phx2:"phx"},p=(e,t,n)=>{switch(n){case"sameorigin":return"/ramen".concat(h[t]).concat(d[e]||"");case"breeze":return"https://ramen".concat(h[t],".uber.com").concat(d[e]||"");case"openid":return"https://ramen".concat(h[t],".uberinternal.com").concat(d[e]||"");default:return"https://cn-".concat(t,".uber.com/ramen").concat(d[e]||"")}},f={altitude:"x-uber-device-location-altitude",app:"x-uber-client-name",authorization:"Authorization",device:"x-uber-device",deviceId:"x-uber-device-id",deviceIds:"x-uber-device-ids",deviceModel:"x-uber-device-model",deviceOS:"x-uber-device-os",epoch:"x-uber-device-epoch",language:"x-uber-device-language",latitude:"latitude",longitude:"longitude",origin:"x-uber-origin",regionId:"x-uber-region-id",service:"x-uber-push-service",source:"x-uber-source",token:"x-uber-token",uuid:"x-uber-uuid",version:"x-uber-client-version",screenflowVersion:"x-uber-screenflow-client-version",appVariant:"x-uber-app-variant"},m=e=>(e.hasOwnProperty("device")||(e.device="web"),Object.keys(e).map((t=>{const n=f[t],r=e[t];if(n&&r)return[n,e[t]]})).filter(Boolean)),g=(e,t)=>e.slice(-1)===t?e.slice(0,-1):e,v=new RegExp(/\n\n$/),b=new RegExp(/^(close|data|event|id|):\s?(.*)/),_=e=>{let[t,n]=["",""];const r=b.exec(e);return r&&3===r.length&&([,t,n]=r),e.length>0&&!e.includes(":")&&(t=e),[t,n]},y=(e,t,n)=>{switch(t){case"event":e.name=n;break;case"data":e.data="".concat(e.data||"").concat(n,"\n");break;case"id":e.id=n}return e},x=e=>{let t={data:"",name:""},n="";return r=>{if(n+=r,v.test(n)){n=g(n,"\n");for(const r of n.split("\n")){if(""===r){t.data=g(t.data||"","\n"),e(t),t={data:"",name:""},n="";continue}if(":"===r[0])continue;const[s,i]=_(r);t=y(t,s,i)}}}};var C=n(72430);function k(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const w="undefined"!=typeof process&&process.release&&"node"===process.release.name,O=e=>"function"==typeof e?e():null,S=(e,t,n)=>({code:t,error:n,stopped:e});class E{constructor(e){k(this,"authenticateUser",(e=>{if(!this.authenticationMethod||"sameorigin"===this.authenticationMethod)return void e();if("undefined"==typeof fetch||fetch.polyfill||w)return void e(S(!0,"unsupported_browser"));const t=p("ACK",this.session.datacenter,this.authenticationMethod);fetch("".concat(t,"?seq=-1"),{credentials:"include",mode:"no-cors"}).then((e=>e.ok?e:fetch("".concat(t,"?seq=-1"),{credentials:"include"}))).then((t=>{const n=200===t.status?void 0:S(!0,"authentication_failed");e(n)})).catch((t=>e(S(!0,"authentication_failed",t))))})),k(this,"startPolling",(e=>{const t=p("RECV",this.session.datacenter,this.authenticationMethod),n="".concat(t,"?seq=").concat(this.session.seq),r=[...m(this.user),["cache-control","no-cache"],["x-uber-client-session",this.session.uuid],this.user.uuid?["x-auth-params-user-uuid",this.user.uuid]:null].filter(Boolean);this.session.stopPolling=((e,t)=>{const n=new XMLHttpRequest,r=c(t.onDisconnect),s=c(t.onConnect),i={lastResponse:Date.now(),xhr:n};let o=0,a=0;return n.onreadystatechange=()=>{if(n.readyState===n.LOADING||n.readyState===n.DONE){n.status<400&&s(null),i.lastResponse=Date.now();const e=n.responseText.substring(a);a=n.responseText.length,t.callback(e)}const e=n.readyState<o;if(o=Math.max(n.readyState,o),n.readyState===n.DONE||e){let s={connectionClosed:n.readyState===n.DONE,responseText:n.responseText,statusCode:n.status,timestamp:(new Date).toISOString(),userAborted:e};t.returnHeaders&&(s={...s,requestHeaders:n._headers,responseHeaders:n.responseHeaders}),r(null,s)}},n.onerror=e=>{n.abort(),r(new Error(e))},n.open("GET",e),n.withCredentials=!0,t.headers.map((e=>{let[t,r]=e;return n.setRequestHeader(t,r)})),n.send(),i.lastResponse=Date.now(),u(i,t.disconnectInterval),()=>n.abort()})(n,{callback:l(x(this.handleEvent),this.maybeSendAck),disconnectInterval:2e4,headers:r,onDisconnect:e,returnHeaders:this.returnHeaders,onConnect:()=>{this.manager&&this.manager.notifyConnection(this)}})})),k(this,"retryPolling",(()=>{const e=Date.now();this.m3Client.increment("request",{method:"recv"}),this.didFirstPoll||(this.m3Client.timing("client-ready",Date.now()-this.initTimestamp),this.didFirstPoll=!0),this.startPolling(((t,n)=>{this.session.active?(t?this.callback(S(!1,"client_error",t),null,this):this.callback(S(!1,"client_disconnected",n),null,this),this.m3Client.timing("latency",Date.now()-e,{method:"recv"}),setTimeout(this.retryPolling,5e3)):this.callback(S(!0,"session_inactive",t),null,this)}))})),k(this,"sendAck",(()=>{const e=p("ACK",this.session.datacenter,this.authenticationMethod),t=Date.now();this.m3Client.increment("request",{method:"ack"}),((e,t,n)=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState===r.DONE){if(r.status<200||r.status>=300){let e={message:r.responseText,status:r.status};return t.returnHeaders&&(e={...e,requestHeaders:r._headers,responseHeaders:r.responseHeaders}),void n(e)}n(null,a(r.responseText))}},r.open(t.method,e),r.timeout=t.timeout||3e4,r.withCredentials=!0,t.headers.map((e=>{let[t,n]=e;return r.setRequestHeader(t,n)})),r.send(t.body||null)})("".concat(e,"?seq=").concat(this.session.seq),{headers:[...m(this.user),["x-uber-client-session",this.session.uuid],this.user.uuid?["x-auth-params-user-uuid",this.user.uuid]:null].filter(Boolean),method:"GET",returnHeaders:this.returnHeaders},(e=>{e&&this.callback(S(!1,"ack_failed",e),null,this),this.m3Client.timing("latency",Date.now()-t,{method:"ack"})}))})),k(this,"handleEvent",(e=>{if((e=>!(e.name||e.data||e.seq))(e))return;if("close"===e.name)return void O(this.session.stopPolling);const{msg:t}=a(e.data);"rmn-msg-v1"===e.name&&Array.isArray(t)?t.map(this.handleMessage):this.callback(S(!1,"unrecognised_message",e),null,this)})),k(this,"handleMessage",(e=>{Number.isFinite(e.seq)&&e.seq>this.session.seq&&(this.session.seq=e.seq),this.callback(null,e,this)})),k(this,"stop",(()=>{this.session.active=!1,O(this.session.stopPolling)})),this.callback=e.callback,this.user=e.user,this.manager=e.manager,this.authenticationMethod=e.authenticationMethod,this.session={active:!0,datacenter:e.datacenter,seq:0,uuid:(0,C.Z)()},this.m3Client=i(e.m3Client)?e.m3Client:o(),this.initTimestamp=Date.now(),this.didFirstPoll=!1,e.returnHeaders&&(this.returnHeaders=!0),this.authenticateUser((e=>{if(e)return this.session.active=!1,void this.callback(e,null,this);this.maybeSendAck=((e,t)=>{let n=Date.now();return r=>(Date.now()-n>=t&&(n=Date.now(),e()),r)})(this.sendAck,3e4),this.retryPolling()}))}}var Z=n(80170),T=n.n(Z);const M=["phx2","dca1"];const D=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.user)throw new Error("RamenJS init error: `options.user` is required");if(!e.user.app)throw new Error("RamenJS init error: `options.user.app` is a required field");this.handlers={message:[],connect:[],disconnect:[],error:[]},this.clients=[],this.disconnectionTimeout=e.disconnectionTimeout||15e3,this.user=e.user;const t=e.dc||e.datacenter||M;return this.dcs=(Array.isArray(t)?t:[t]).reduce(((e,t)=>(e[t]={status:"disconnected",timeout:null},e)),{}),this.authenticationMethod=e.authenticationMethod||"sameorigin",this.m3Client=i(e.m3Client)?e.m3Client:o(),this.mockedClient=e.mockedClient||!1,this}on(e,t){return this.handlers.hasOwnProperty(e)&&(this.handlers[e].push(t),this.initializeClients()),this}off(e,t){if(!this.handlers.hasOwnProperty(e))return this;if(!t&&this.handlers[e].length)this.handlers[e]=[];else{const n=this.handlers[e].indexOf(t);-1!==n&&this.handlers[e].splice(n,1)}return this.hasSubscribers()||this.stopClients(),this}initializeClients(){this.clients.length||this.mockedClient||Object.keys(this.dcs).forEach((e=>{const t=new E({datacenter:e,user:this.user,authenticationMethod:this.authenticationMethod,m3Client:this.m3Client,callback:this.handleClientResponse.bind(this),manager:this});this.clients.push(t)}))}handleClientResponse(e,t,n){if(e){const t=n.session.datacenter;this.dcs[t]&&(this.dcs[t].lastError=e,this.dcs[t].timeout||"disconnected"===this.dcs[t].status||(this.dcs[t].timeout=setTimeout((()=>{this.dcs[t].status="disconnected",this.dcs[t].timeout=null,this.trigger("disconnect",{...this.getConnectionStatus(),error:this.dcs[t].lastError},n)}),this.disconnectionTimeout))),this.trigger("error",e,n)}else if(t){let e=t.msg;try{e=JSON.parse("".concat(e))}catch(e){this.trigger("error","parsing error ".concat(e),n)}this.trigger("message",{...t,msg:e},n)}}trigger(e,t,n){const r=n?{dc:T()(n,"session.datacenter")}:{};this.handlers[e].forEach((e=>{e(t,r)}))}stopClients(){}hasSubscribers(){for(let e of Object.keys(this.handlers))if(this.handlers[e].length)return!0;return!1}getConnectionStatus(){let e=!1,t=!1;return{details:Object.keys(this.dcs).reduce(((n,r)=>{const s=this.dcs[r].status;return"connected"===s?t=!0:e=!0,n[r]=s,n}),{}),status:t?e?"limited":"connected":"disconnected"}}notifyConnection(e){const t=e.session.datacenter,n=T()(this.dcs[t],"timeout");clearTimeout(n);let r="connected"!==T()(this.dcs[t],"status");this.dcs[t]={status:"connected",timeout:null,lastError:null},r&&this.trigger("connect",this.getConnectionStatus(),e)}};var R=n(46643),H=n(85040),P=n(74056),I=n(72525),B=n(1977),A=n(16382),L=n(76325),$=n(99456),F=n(61072),N=n(59092),j=n(70537),q=n(46945),z=n(41254),U=n(93286),V=n(11101),G=n(20927),X=n(52671),K=n(37175),J=n(62973),Q=n(87531),W=n(25213),Y=n(4824),ee=n(84151);const te=["pendingRating","ratingSubmitted","orderRating"];const ne=()=>{var e;const t=(0,V.Z)(),n=(0,j.Z)(),s=(0,N.ZP)(),i=(0,R.k6)(),o=(0,G.TH)(),a=(0,H.Z)(),{user:c}=(0,P.Z)(),u=null===(e=c.data)||void 0===e?void 0:e.isLoggedIn;let l=(0,I.Z)("web_ramen");const d=(0,I.Z)("nsw_age_verification"),h=(0,L.I0)(),p=(0,$.v)((e=>{let{ramen:t}=e;return t})),f=(0,r.useRef)(0),m=(0,r.useRef)(null),g=(0,r.useRef)({}),v="postmates"===(0,q.Z)(),b=(0,U.kR)(t),_=function(){const e=(0,I.Z)("eater_message_interstitials"),t=(0,K.Z)(),n=(0,N.ZP)(),{search:s,pathname:i}=(0,G.TH)(),{getEaterMessageInterstitialSessionCapper:o}=(0,J.Z)(),{isSavingsLanding:a,isSavingsLandingInterstitial:c}=(0,W.Z)(),u=a||c,l=(0,r.useCallback)((e=>Boolean((0,R.LX)(i,e))),[i]);return(0,r.useCallback)((r=>{var i;if(null==r||null===(i=r.messages)||void 0===i||!i.length)return!1;const{surface:a,surfaceId:c,message:d}=r.messages[0]||{},h=t({surface:a,surfaceId:c,...d});n("eats:eater_message_ramen_log",{eaterMessage:{ramenMsg:JSON.stringify(r),surface:c||X.cx.UNKNOWN}});const p=String(ee.parse(s)[F.FSm.modalName]),f=te.includes(p),m=Boolean(h),g=null==h?void 0:h.payload,v="modalPayload"===(null==g?void 0:g.type)&&(null==g?void 0:g.modalPayload.uuid)||"",{hasPromotionBanner:b,hasExpandedModalState:_}=(0,Q.X1)(h),y=!u&&(!b||_);switch(c){case X.cx.HOME_FEED_PUSH_BOTTOM_MODAL:return e&&!o(X.cx.HOME_FEED_PUSH_BOTTOM_MODAL,v)&&m&&y&&l(Y.r.home_feed);case X.cx.VERTICAL_FEED_PUSH_BOTTOM_MODAL:return e&&!o(X.cx.VERTICAL_FEED_PUSH_BOTTOM_MODAL,v)&&m&&y&&l(Y.r.vertical_feed);case X.cx.ORDER_TRACKING_PUSH_BOTTOM_MODAL:return e&&!o(X.cx.ORDER_TRACKING_PUSH_BOTTOM_MODAL,v)&&m&&!l(Y.r.vertical_feed);case X.cx.ORDER_COMPLETE_PUSH_BOTTOM_MODAL:return e&&!o(X.cx.ORDER_COMPLETE_PUSH_BOTTOM_MODAL,v)&&!f&&m;default:return!1}}),[s,e,o,n,t,u,l])}(),y=(0,r.useContext)(z.k7),x=(0,r.useCallback)((e=>{y.set("chatMessageUuid",e)}),[y]),k=(0,r.useCallback)((e=>{switch(e.type){case"chat":return void("system"!==e.msg.messageType&&x(e.uuid));case"eater_message_service_screen_messages":if(_(e.msg)){const t=(e.msg.messages||[])[0].surfaceId||"";i.push((0,F.tLx)(o,t))}return;case"home_membership_modal":return s("eats:home_membership_modal_ramen_message_received"),void i.push((0,F.bAD)(o,e.uuid));case"push_web_eats_verification_result":return void(d&&i.push((0,F.fDg)(o,e.msg.flowStatus)));default:return}}),[x,_,i,o,s,d]);return(0,r.useEffect)((()=>{if(p.messageQueue.length>0&&f.current<p.messageQueue.length){for(let e=f.current;e<p.messageQueue.length;e++){const t=p.messageQueue[e]||"",n=p.messageMap[t];n&&k(n)}f.current=p.messageQueue.length}}),[k,p]),(0,r.useEffect)((()=>{l&&u&&!m.current&&(m.current=new D({m3Client:a,user:{app:"eats_web",device:"eats-web",deviceId:b||(0,C.Z)(),language:n,origin:"eats-web",source:"eats-web",version:"1.0.0",appVariant:v?"postmates":"ubereats"}}).on("message",(e=>{const t=(0,B.n)(e);return t&&!g.current[t.uuid]&&h((0,A.l)(t)),t&&(g.current[t.uuid]=!0),()=>{m.current&&m.current.off("message")}})))}),[h,u,l,n,a,v,b]),null}},69061:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(99456),s=n(53563);const i=()=>(0,r.v)((e=>{let{features:t}=e;return t}))[s.h6.capital_one_promo]},62973:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(36151),s=n(35944),i=n(11101),o=n(93286);const a="uev2.messaging-interstitial-session-capper";function c(){const e=(0,i.Z)(),t=(0,o.Yk)(e),n=(0,s._)(),c=(0,r.useCallback)((()=>n.get(a)||{}),[n]);return{getEaterMessageInterstitialSessionCapper:(0,r.useCallback)(((e,n)=>{const r=c()[e];return(null==r?void 0:r.sessionId)===t&&((null==r?void 0:r.campaigns)||[]).includes(n)}),[c,t]),setEaterMessageInterstitialSessionCapper:(0,r.useCallback)(((e,r)=>{const s=c(),i=s[e],o=(null==i?void 0:i.sessionId)===t&&null!=i&&i.campaigns?i.campaigns:[];o.includes(r)||o.push(r),s[e]={sessionId:t||"",campaigns:o},n.set(a,s)}),[n,t,c])}}},17251:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(85897),s=n(29778);const i=()=>(0,r.ip)({...s.J.scheduled_order_editing,defaultValue:!1})},82612:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(85897),s=n(29778);const i=()=>(0,r.ip)({...s.J.is_repeat_group_order_enabled,defaultValue:!1})},85040:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(72670),s=n(28582);function i(){return(0,r.G2)(s.EK)}},19071:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(36151),s=n(99456),i=n(41254),o=n(33888),a=n(78873);function c(){const e=(0,a.Z)(),t=(0,s.v)((e=>{let{embeddedFeatures:t}=e;return t})),n=(0,r.useContext)(i.k7),c=(0,o.Z)("emitXlbHomeFeedEventV1");return(0,r.useCallback)((r=>{let{source:s}=r;if(!e)return;let i=!0;if(t.prefetch){n.set("uev2.xlb_".concat(s,"_impression"),"true");const e=n.get("uev2.xlb_feed_loaded_impression"),t=n.get("uev2.xlb_user_triggered_impression");i=e&&t}i&&c()}),[e,t.prefetch,n,c])}}}]);